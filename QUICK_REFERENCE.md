# üöÄ –ë—ã—Å—Ç—Ä–∞—è —Å–ø—Ä–∞–≤–∫–∞ - MAX Bot Long Polling

## –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

```bash
# –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ
conda activate max

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ë–î
sudo docker compose up -d db

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
./start_bot.sh
# –∏–ª–∏
python longpolling_bot.py
```

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞ –≤ MAX

```
/–∑–∞–¥–∞—á–∏              - –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á
/–≥–æ—Ç–æ–≤–æ 5            - –æ—Ç–º–µ—Ç–∏—Ç—å –∑–∞–¥–∞—á—É #5 –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π
/—Å–æ–∑–¥–∞—Ç—å –ù–∞–∑–≤–∞–Ω–∏–µ    - —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É
/–ø–æ–º–æ—â—å              - –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```bash
# –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã
python demo_bot.py

# –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º
python demo_bot.py --interactive

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
python test_bot_setup.py
```

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ë–î

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å
sudo docker compose up -d db

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
sudo docker compose down

# –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
sudo docker compose restart db

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏
docker compose logs -f db

# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ –ë–î
docker exec -it tasker_max_db psql -U tasker_user -d tasker
```

## –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `longpolling_bot.py` | ‚≠ê –û—Å–Ω–æ–≤–Ω–æ–π –±–æ—Ç |
| `demo_bot.py` | üé¨ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è |
| `test_bot_setup.py` | üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ |
| `start_bot.sh` | üöÄ –°–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ |

## –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

| –§–∞–π–ª | –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ |
|------|------------|
| `INSTALL.md` | –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ |
| `BOT_USAGE.md` | –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é |
| `LONG_POLLING_README.md` | –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞ |
| `IMPLEMENTATION_SUMMARY.md` | –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è |
| `QUICK_REFERENCE.md` | –≠—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞ |

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
export MAX_BOT_TOKEN="–≤–∞—à_—Ç–æ–∫–µ–Ω"
export DATABASE_URL="postgresql://user:pass@localhost:5432/tasker"
```

## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

| –ü—Ä–æ–±–ª–µ–º–∞ | –†–µ—à–µ–Ω–∏–µ |
|----------|---------|
| –ë–î –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è | `sudo docker compose up -d db` |
| –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç | –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω: `echo $MAX_BOT_TOKEN` |
| –û—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ | `pip install -r requirements.txt` |
| –ù–µ—Ç –ø—Ä–∞–≤ Docker | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `sudo` |

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ë–î

### –¢–∞–±–ª–∏—Ü–∞ `chats`
- `id` - –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π ID
- `max_chat_id` - ID –≤ MAX
- `name` - –Ω–∞–∑–≤–∞–Ω–∏–µ

### –¢–∞–±–ª–∏—Ü–∞ `tasks`
- `id` - ID –∑–∞–¥–∞—á–∏
- `chat_id` - —Å—Å—ã–ª–∫–∞ –Ω–∞ —á–∞—Ç
- `creator_id` - —Å–æ–∑–¥–∞—Ç–µ–ª—å
- `assignee_id` - –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å
- `title` - –Ω–∞–∑–≤–∞–Ω–∏–µ
- `description` - –æ–ø–∏—Å–∞–Ω–∏–µ
- `status` - active/completed/archived
- `created_at`, `deadline`, `completed_at`

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É
```
–í—ã ‚Üí –ë–æ—Ç: /—Å–æ–∑–¥–∞—Ç—å –ù–∞–ø–∏—Å–∞—Ç—å –æ—Ç—á–µ—Ç
–ë–æ—Ç ‚Üí –í—ã: ‚úÖ –ó–∞–¥–∞—á–∞ #1 —Å–æ–∑–¥–∞–Ω–∞!
```

### –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∑–∞–¥–∞—á–∏
```
–í—ã ‚Üí –ë–æ—Ç: /–∑–∞–¥–∞—á–∏
–ë–æ—Ç ‚Üí –í—ã: üìã –í–∞—à–∏ –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏ (1):
          1. [1] –ù–∞–ø–∏—Å–∞—Ç—å –æ—Ç—á–µ—Ç
```

### –ó–∞–≤–µ—Ä—à–∏—Ç—å –∑–∞–¥–∞—á—É
```
–í—ã ‚Üí –ë–æ—Ç: /–≥–æ—Ç–æ–≤–æ 1
–ë–æ—Ç ‚Üí –í—ã: ‚úÖ –ó–∞–¥–∞—á–∞ #1 –æ—Ç–º–µ—á–µ–Ω–∞ –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–∞—è!
```

## Long Polling API

### –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
```
GET https://botapi.max.ru/updates?offset=N&timeout=60
Authorization: YOUR_TOKEN
```

### –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
```
POST https://botapi.max.ru/messages?user_id=ID
Authorization: YOUR_TOKEN
Body: {"text": "...", "notify": true}
```

## –õ–æ–≥–∏

–ë–æ—Ç –≤—ã–≤–æ–¥–∏—Ç –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏:
```
üì¨ –ü–æ–ª—É—á–µ–Ω–æ N –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
üì® –ü–æ–ª—É—á–µ–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç USER_ID: —Ç–µ–∫—Å—Ç
‚úÖ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ N –∑–∞–¥–∞—á –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é USER_ID
```

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ñ–∞–π–ª—ã
ls -lh *.py *.md *.sh

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Python
python --version

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å conda
conda env list

# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–æ—Ç–∞
Ctrl+C

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–æ—Ü–µ—Å—Å—ã
ps aux | grep longpolling_bot
```

---

**–î–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —Å–º.:** `INSTALL.md`, `BOT_USAGE.md`

